---
lang: zh
layout: /src/layouts/Blog.astro
title: 'Typescript知识梳理'
subtitle: ''
poster: '/images/astro.jpg'
permalink: 'Typescript知识梳理'
createdAt: '2024-07-27 23:40:10'
---

最近使用 ts 时大部分精力都放在了怎么写完整的类型上，反而基础知识框架有些遗忘现象，导致项目搭建时遇到了一些问题，写这篇文章来重新梳理下我的 typescript 知识框架，也是通过实践来巩固理论知识。

## 知识结构

### 基础（The Basics）

#### 静态类型检查

```ts
const message = 'hello!';

message();
// Error: 'message' is not a function
```

#### 非异常故障

```ts
const user = {
  name: 'Daniel',
  age: 26,
};

user.location;
// Error: Property 'location' does not exist on type '{ name: string; age: number; }'
```

不做重点展开，详见[文档](https://www.typescriptlang.org/docs/handbook/2/basic-types.html)

...

#### Downleveling 降级

typescript 会将高版本的代码降级为低版本的代码，比如 es6 降级为 es5。

### 基础类型

#### 原始类型（primitives）：`stirng`, `number`, `boolean`

`String`, `Number`, `Boolean` 也是合法的语法，但是引用了一些很少出现在代码中的特殊内置类型。始终使用 `string`,`number`,`boolean` 就可以。

以 `String` 和 `string` 为例：

`string` 是原始类型，而 `String` 是非原始类型装箱对象

```ts
const Str: String = '';

const newStr: string = Str;
// Type 'String' is not assignable to type 'string'.
// 'string' is a primitive, but 'String' is a wrapper object. Prefer using 'string' when possible.(2322)

/* WRONG */
function reverse(str: String): String;

/* OK */
function reverse(s: string): string;
```

#### 类型别名和接口（type and interface）

从一个例子开始：

```ts
function greet(person: { name: string; age: number }) {
  return 'Hello ' + person.name;
}
```

这个函数中的参数 `person` 的类型是一个匿名类型，我们可以使用 `type` 或者 `interface` 给这个类型起一个名字

```ts
type Person = { name: string; age: number };
// or
interface Person {
  name: string;
  age: number;
}

function greet(person: Person) {
  return 'Hello ' + person.name;
}
```

`type` 和 `interface` 有很多相似之处，但是也有一些不同：

- `type` 可以是任何类型的别名，而 `interface` 只能命名对象类型

```ts
type Point = { x: number; y: number };
type ID = string | number;
type Name = string;
type Greet = (name: string) => string;
```

- `interface` 可以扩展，而 `type` 不行

```ts
interface Person {
  name: string;
}
interface Person {
  age: number;
}
```

```ts
type Person = {
  name: string;
};
type Person = {
  age: number;
};
// Duplicate identifier 'Person'.(2300)
```

- `interface` 合并时会创建一个扁平的 `object` 类型来检测属性冲突，而 `type` 只会进行简单的递归合并，往往会产生 `never` 类型
  ![image01](image01.png)

- 对于编译器来说，[使用带有扩展的接口通常比带有交集的类型别名具有更高的性能](https://github.com/microsoft/TypeScript/wiki/Performance#preferring-interfaces-over-intersections)

- `interface` 始终以原始形式出现在错误信息中（以名字的形式使用时），在 4.2 版本之前 `type` 可能会出现在错误消息中，有时也会以等效的匿名类型替换

综上，大部分情况下使用 `interface` 即可直到需要使用 `type` 的特性时再使用 `type`
